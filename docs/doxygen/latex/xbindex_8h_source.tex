\hypertarget{xbindex_8h_source}{}\doxysection{xbindex.\+h}
\label{xbindex_8h_source}\index{/mnt/1Tdata/xbase/xbase64-\/4.1.11/src/include/xbindex.h@{/mnt/1Tdata/xbase/xbase64-\/4.1.11/src/include/xbindex.h}}
\mbox{\hyperlink{xbindex_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*  xbindex.h}}
\DoxyCodeLine{2 \textcolor{comment}{}}
\DoxyCodeLine{3 \textcolor{comment}{XBase64 Software Library}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{Copyright (c) 1997,2003,2014, 2018, 2022, 2024 Gary A Kunkel}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{The xb64 software library is covered under the terms of the GPL Version 3, 2007 license.}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{Email Contact:}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{    XDB-\/devel@lists.sourceforge.net}}
\DoxyCodeLine{12 \textcolor{comment}{    XDB-\/users@lists.sourceforge.net}}
\DoxyCodeLine{13 \textcolor{comment}{}}
\DoxyCodeLine{14 \textcolor{comment}{*/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#ifndef \_\_XB\_INDEX\_H\_\_}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#define \_\_XB\_INDEX\_H\_\_}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#ifdef XB\_INDEX\_SUPPORT}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#define XB\_ADD\_KEY 1}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define XB\_UPD\_KEY 2}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#define XB\_DEL\_KEY 3}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacexb}{xb}}\{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 }
\DoxyCodeLine{30 }
\DoxyCodeLine{32 \textcolor{comment}{// structure for index nodes, each node contains information regarding one block}}
\DoxyCodeLine{33 \textcolor{keyword}{struct }XBDLLEXPORT xbIxNode \{}
\DoxyCodeLine{34   xbIxNode *npPrev;                     \textcolor{comment}{// pointer to previous node in chain}}
\DoxyCodeLine{35   xbIxNode *npNext;                     \textcolor{comment}{// pointer to next node in chain}}
\DoxyCodeLine{36   xbUInt32 iCurKeyNo;                   \textcolor{comment}{// current key number in the node, 0 offset}}
\DoxyCodeLine{37   xbUInt32 ulBlockNo;                   \textcolor{comment}{// this block number}}
\DoxyCodeLine{38   xbUInt32 ulBufSize;                   \textcolor{comment}{// size of cpBlockData}}
\DoxyCodeLine{39   \textcolor{keywordtype}{char}     *cpBlockData;                \textcolor{comment}{// pointer to memory version of block data stored in file}}
\DoxyCodeLine{40 \};}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 }
\DoxyCodeLine{45 }
\DoxyCodeLine{120 \textcolor{keyword}{class }XBDLLEXPORT xbIx : \textcolor{keyword}{public} xbFile \{}
\DoxyCodeLine{121  \textcolor{keyword}{public}:}
\DoxyCodeLine{122    xbIx( xbDbf * d );}
\DoxyCodeLine{123    \textcolor{keyword}{virtual} \string~xbIx();}
\DoxyCodeLine{124 }
\DoxyCodeLine{125    \textcolor{keyword}{virtual} xbInt16  CheckTagIntegrity( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt ) = 0;}
\DoxyCodeLine{126    \textcolor{keyword}{virtual} xbInt16  Close();}
\DoxyCodeLine{127    \textcolor{keyword}{virtual} xbInt16  CreateTag( \textcolor{keyword}{const} xbString \&sName, \textcolor{keyword}{const} xbString \&sKey, \textcolor{keyword}{const} xbString \&sFilter, xbInt16 iDescending, xbInt16 iUnique, xbInt16 iOverlay, \textcolor{keywordtype}{void} **vpTag ) = 0;}
\DoxyCodeLine{128    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} xbString \&sKey, xbInt16 iRetrieveSw );}
\DoxyCodeLine{129    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} \textcolor{keywordtype}{char} * cKey, xbInt32 lKeyLen, xbInt16 iRetrieveSw );}
\DoxyCodeLine{130    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} xbBcd \&bcd, xbInt16 iRetrieveSw );}
\DoxyCodeLine{131    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} xbDate \&dtKey, xbInt16 iRetrieveSw );}
\DoxyCodeLine{132    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \mbox{\hyperlink{namespacexb_a25f47b226ce924a5c78f97989b0744a2}{xbDouble}} dKey, xbInt16 iRetrieveSw );}
\DoxyCodeLine{133    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vKey, xbInt32 lKeyLen, xbInt16 iRetrieveSw ) = 0;}
\DoxyCodeLine{134    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     *GetCurTag() \textcolor{keyword}{const};}
\DoxyCodeLine{135 }
\DoxyCodeLine{136    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbString \&s ) = 0;}
\DoxyCodeLine{137    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, \mbox{\hyperlink{namespacexb_a25f47b226ce924a5c78f97989b0744a2}{xbDouble}} \&d ) = 0;}
\DoxyCodeLine{138    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbDate \&dt ) = 0;}
\DoxyCodeLine{139 }
\DoxyCodeLine{140    \textcolor{keyword}{virtual} xbDbf    *GetDbf() \textcolor{keyword}{const};}
\DoxyCodeLine{141 }
\DoxyCodeLine{142    \textcolor{keyword}{virtual} xbInt16  GetIxTagMode( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144    \textcolor{keyword}{virtual} xbString \&GetKeyExpression( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{145    \textcolor{keyword}{virtual} xbString \&GetKeyFilter( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{146    \textcolor{keyword}{virtual} \textcolor{keywordtype}{char}     GetKeyType( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{147    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetLocked() \textcolor{keyword}{const};}
\DoxyCodeLine{148 }
\DoxyCodeLine{149    \textcolor{keyword}{virtual} xbInt16  GetFirstKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw ) = 0;}
\DoxyCodeLine{150    \textcolor{keyword}{virtual} xbInt16  GetFirstKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{151    \textcolor{keyword}{virtual} xbInt16  GetFirstKey();}
\DoxyCodeLine{152 }
\DoxyCodeLine{153    \textcolor{keyword}{virtual} xbInt16  GetLastKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw ) = 0;}
\DoxyCodeLine{154    \textcolor{keyword}{virtual} xbInt16  GetLastKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{155    \textcolor{keyword}{virtual} xbInt16  GetLastKey();}
\DoxyCodeLine{156 }
\DoxyCodeLine{157    \textcolor{keyword}{virtual} xbInt16  GetNextKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw ) = 0;}
\DoxyCodeLine{158    \textcolor{keyword}{virtual} xbInt16  GetNextKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{159    \textcolor{keyword}{virtual} xbInt16  GetNextKey();}
\DoxyCodeLine{160 }
\DoxyCodeLine{161    \textcolor{keyword}{virtual} xbInt16  GetPrevKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw ) = 0;}
\DoxyCodeLine{162    \textcolor{keyword}{virtual} xbInt16  GetPrevKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{163    \textcolor{keyword}{virtual} xbInt16  GetPrevKey();}
\DoxyCodeLine{164 }
\DoxyCodeLine{165    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     *GetTag( xbInt16 iTagNo ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{166    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     *GetTag( xbString \&sTagName ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{167    \textcolor{keyword}{virtual} xbInt16  GetTagCount() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{168 }
\DoxyCodeLine{169    \textcolor{keyword}{virtual} xbString \&GetTagName( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{170    \textcolor{keyword}{virtual} \textcolor{keyword}{const} \textcolor{keywordtype}{char} * GetTagName( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{171    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     GetTagName( \textcolor{keywordtype}{void} *vpTag, xbString \&sTagName ) \{\};}
\DoxyCodeLine{172    \textcolor{keyword}{virtual} \textcolor{keyword}{const}    xbString \&GetType() \textcolor{keyword}{const};}
\DoxyCodeLine{173 }
\DoxyCodeLine{174    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetUnique( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{175    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetSortOrder( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{176 }
\DoxyCodeLine{177    \textcolor{keyword}{virtual} xbInt16  Open( \textcolor{keyword}{const} xbString \&sFileName );}
\DoxyCodeLine{178    \textcolor{keyword}{virtual} xbInt16  SetCurTag( xbInt16 iTagNo ) = 0;}
\DoxyCodeLine{179    \textcolor{keyword}{virtual} xbInt16  SetCurTag( xbString \&sTagName ) = 0;}
\DoxyCodeLine{180    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     SetCurTag( \textcolor{keywordtype}{void} * vpCurTag );}
\DoxyCodeLine{181    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     SetLocked( \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}} bLocked );}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{preprocessor}{   \#ifdef XB\_DEBUG\_SUPPORT}}
\DoxyCodeLine{185    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     TestStub( \textcolor{keywordtype}{char} *s, \textcolor{keywordtype}{void} *vpTag ) \{\};}
\DoxyCodeLine{186 }
\DoxyCodeLine{187 }
\DoxyCodeLine{188    \textcolor{keyword}{virtual} xbInt16 DumpFreeBlocks( xbInt16 iOpt = 0 ) \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{xbretcod_8h_ac720d5b4ec45bfd606f5865d40816e23}{XB\_NO\_ERROR}}; \}}
\DoxyCodeLine{189    \textcolor{keyword}{virtual} xbInt16 DumpHeader( xbInt16 iDestOpt = 0, xbInt16 iFmtOpt = 0 ) = 0;}
\DoxyCodeLine{190    \textcolor{keyword}{virtual} xbInt16 DumpIxForTag( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt ) = 0;}
\DoxyCodeLine{191    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}    DumpIxNodeChain( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{192    \textcolor{keyword}{virtual} xbInt16 DumpNode( \textcolor{keywordtype}{void} * vpTag, xbIxNode * pNode, xbInt16 iOption ) \textcolor{keyword}{const};}
\DoxyCodeLine{193    \textcolor{keyword}{virtual} xbInt16 DumpTagBlocks( xbInt16 iOpt = 1, \textcolor{keywordtype}{void} *vpTag = NULL  ) = 0;}
\DoxyCodeLine{194 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{195 }
\DoxyCodeLine{196  \textcolor{keyword}{protected}:}
\DoxyCodeLine{197    \textcolor{keyword}{friend}  \textcolor{keyword}{class    }xbDbf;}
\DoxyCodeLine{198 }
\DoxyCodeLine{199    \textcolor{keyword}{virtual} xbInt16  AddKey( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo ) = 0;}
\DoxyCodeLine{200    \textcolor{keyword}{virtual} xbInt16  AddKeys( xbUInt32 ulRecNo );}
\DoxyCodeLine{201    \textcolor{keyword}{virtual} xbIxNode *AllocateIxNode( xbUInt32 ulBufSize = 0, xbInt16 iOption = 0 );}
\DoxyCodeLine{202    \textcolor{keyword}{virtual} xbInt16  BSearchBlock( \textcolor{keywordtype}{char} cKeyType, xbIxNode *npNode, xbInt32 lKeyLen, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpKey, xbInt32 lSearchKeyLen, xbInt16 \&iCompRc, \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}} bDescending = \mbox{\hyperlink{xbtypes_8h_adc4b6ca5ad299f63675136d9e03938cc}{xbFalse}} ) \textcolor{keyword}{const};}
\DoxyCodeLine{203    \textcolor{keyword}{virtual} xbInt16  CheckForDupKeys();}
\DoxyCodeLine{204    \textcolor{keyword}{virtual} xbInt16  CheckForDupKey( \textcolor{keywordtype}{void} *vpTag ) = 0;}
\DoxyCodeLine{205    \textcolor{keyword}{virtual} xbInt16  CompareKey( \textcolor{keywordtype}{char} cKeyType, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *v1, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *v2, \textcolor{keywordtype}{size\_t} lKeyLen ) \textcolor{keyword}{const};}
\DoxyCodeLine{206    \textcolor{keyword}{virtual} xbInt16  CreateKeys( xbInt16 iOpt );}
\DoxyCodeLine{207    \textcolor{keyword}{virtual} xbInt16  CreateKey( \textcolor{keywordtype}{void} * vpTag, xbInt16 iOpt ) = 0;}
\DoxyCodeLine{208    \textcolor{keyword}{virtual} xbInt16  DeleteFromNode( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo ) = 0;}
\DoxyCodeLine{209    \textcolor{keyword}{virtual} xbInt16  DeleteKeys();}
\DoxyCodeLine{210    \textcolor{keyword}{virtual} xbInt16  DeleteKey( \textcolor{keywordtype}{void} *vpTag ) = 0;}
\DoxyCodeLine{211    \textcolor{keyword}{virtual} xbInt16  DeleteTag( \textcolor{keywordtype}{void} *vpTag ) = 0;}
\DoxyCodeLine{212 }
\DoxyCodeLine{213    \textcolor{keyword}{virtual} xbInt16  FindKeyForCurRec( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 0 ) = 0;}
\DoxyCodeLine{214    \textcolor{keyword}{virtual} xbIxNode *FreeNodeChain( xbIxNode *np );}
\DoxyCodeLine{215    \textcolor{keyword}{virtual} xbInt16  GetBlock( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulBlockNo, xbInt16 iOpt, xbUInt32 ulAddlBuf = 0 );}
\DoxyCodeLine{216    \textcolor{keyword}{virtual} xbInt32  GetKeyCount( xbIxNode *npNode ) \textcolor{keyword}{const};}
\DoxyCodeLine{217    \textcolor{keyword}{virtual} \textcolor{keywordtype}{char}     *GetKeyData( xbIxNode *npNode, xbInt16 iKeyNo, xbInt16 iKeyItemLen ) \textcolor{keyword}{const};}
\DoxyCodeLine{218    \textcolor{keyword}{virtual} xbInt16  GetKeySts( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{219    \textcolor{keyword}{virtual} xbInt16  GetLastKey( xbUInt32 ulNodeNo, \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw ) = 0;}
\DoxyCodeLine{220    \textcolor{keyword}{virtual} xbInt16  InsertNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo, \textcolor{keywordtype}{char} * cpKeyBuf, xbUInt32 uiPtr ) = 0;}
\DoxyCodeLine{221    \textcolor{keyword}{virtual} xbInt16  InsertNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo, xbUInt32 uiPtr ) = 0;}
\DoxyCodeLine{222    \textcolor{keyword}{virtual} xbInt16  KeyExists( \textcolor{keywordtype}{void} * ) = 0;}
\DoxyCodeLine{223    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     NodeFree( xbIxNode * ixNode );}
\DoxyCodeLine{224    \textcolor{keyword}{virtual} xbInt16  ReadHeadBlock( xbInt16 iOpt = 0 ) = 0;}
\DoxyCodeLine{225    \textcolor{keyword}{virtual} xbInt16  ReindexTag( \textcolor{keywordtype}{void} **vpTag ) = 0;}
\DoxyCodeLine{226    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     SetDbf( xbDbf *dbf );}
\DoxyCodeLine{227    \textcolor{keyword}{virtual} xbInt16  SetIxTagMode( \textcolor{keywordtype}{void} *vpTag, xbInt16 iMode ) = 0;}
\DoxyCodeLine{228    \textcolor{keyword}{virtual} xbInt16  SplitNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, \textcolor{keywordtype}{char} *cpKeyBuf, xbUInt32 uiPtr ) = 0;}
\DoxyCodeLine{229    \textcolor{keyword}{virtual} xbInt16  SplitNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, xbUInt32 uiPtr ) = 0;}
\DoxyCodeLine{230    \textcolor{keyword}{virtual} xbInt16  UpdateTagKey( \textcolor{keywordtype}{char} cAction, \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo = 0 ) = 0;}
\DoxyCodeLine{231    \textcolor{keyword}{virtual} xbInt16  WriteHeadBlock( xbInt16 iOption ) = 0;}
\DoxyCodeLine{232 }
\DoxyCodeLine{233    xbDbf    *dbf;}
\DoxyCodeLine{234    \textcolor{keywordtype}{char}     *cNodeBuf;               \textcolor{comment}{// pointer to memory for processing in a block of index data}}
\DoxyCodeLine{235    \textcolor{keywordtype}{void}     *vpCurTag;               \textcolor{comment}{// pointer to active tag.  Single index files have only one tag}}
\DoxyCodeLine{236    xbString sIxType;}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 }
\DoxyCodeLine{239  \textcolor{keyword}{private}:}
\DoxyCodeLine{240    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     AppendNodeChain( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode ) = 0;}
\DoxyCodeLine{241    \textcolor{keyword}{virtual} xbInt16  GetKeyPtr( \textcolor{keywordtype}{void} *vpTag, xbInt16 iKeyNo, xbIxNode *npNode, xbUInt32 \&ulKeyPtr ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{242    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   IsLeaf( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode ) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{243    \textcolor{comment}{// virtual void     SetCurNode( void *vpTag, xbIxNode *npNode ) = 0;}}
\DoxyCodeLine{244 }
\DoxyCodeLine{245    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   bLocked;               \textcolor{comment}{// index file locked?}}
\DoxyCodeLine{246 \};}
\DoxyCodeLine{247 }
\DoxyCodeLine{248 \textcolor{preprocessor}{\#ifdef XB\_NDX\_SUPPORT}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250 \textcolor{preprocessor}{\#define XB\_NDX\_BLOCK\_SIZE 512}}
\DoxyCodeLine{251 }
\DoxyCodeLine{252 }
\DoxyCodeLine{254 \textcolor{keyword}{struct }XBDLLEXPORT xbNdxTag \{}
\DoxyCodeLine{255 }
\DoxyCodeLine{256    \textcolor{comment}{// NDX File Header Fields}}
\DoxyCodeLine{257    xbUInt32 ulRootBlock;     \textcolor{comment}{// header node is 0}}
\DoxyCodeLine{258    xbUInt32 ulTotalBlocks;   \textcolor{comment}{// includes header node}}
\DoxyCodeLine{259    \textcolor{keywordtype}{char}     cKeyType;        \textcolor{comment}{// C = Char, F = Numeric, D = Date}}
\DoxyCodeLine{260    xbInt16  iKeyLen;         \textcolor{comment}{// length of key data}}
\DoxyCodeLine{261    xbInt16  iKeysPerBlock;   \textcolor{comment}{// max number keys per block  <=100}}
\DoxyCodeLine{262    xbInt16  iKeyType;        \textcolor{comment}{// 00 = Char, 01 = Numeric}}
\DoxyCodeLine{263    xbInt16  iKeyItemLen;     \textcolor{comment}{// KeyLen + 8 bytes}}
\DoxyCodeLine{264    \textcolor{keywordtype}{char}     cSerNo;          \textcolor{comment}{// rolling incrementing serial number +1 on each index update}}
\DoxyCodeLine{265    xbInt16  iUnique;         \textcolor{comment}{// True if unique}}
\DoxyCodeLine{266    xbString sKeyExpression;  \textcolor{comment}{// index expression}}
\DoxyCodeLine{267    \textcolor{comment}{// end of NDX Header field}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269    xbExp     *exp;           \textcolor{comment}{// pointer to expression for expression keys}}
\DoxyCodeLine{270    time\_t    tNodeChainTs;   \textcolor{comment}{// node chain time stamp}}
\DoxyCodeLine{271    xbIxNode  *npNodeChain;}
\DoxyCodeLine{272    xbIxNode  *npCurNode;}
\DoxyCodeLine{273    \textcolor{keywordtype}{char}      *cpKeyBuf;     \textcolor{comment}{// key buffer, for searches and adds}}
\DoxyCodeLine{274    \textcolor{keywordtype}{char}      *cpKeyBuf2;    \textcolor{comment}{// key buffer, for deletes}}
\DoxyCodeLine{275    xbString  sTagName;      \textcolor{comment}{// tag name -\/ is the file name without the extension}}
\DoxyCodeLine{276    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}    bFoundSts;     \textcolor{comment}{// key found?  used to determine if new key should be added in XB\_EMULATE\_DBASE mode in AddKey}}
\DoxyCodeLine{277 }
\DoxyCodeLine{278 }
\DoxyCodeLine{279    xbInt16   iKeySts;       \textcolor{comment}{// key updated?  set in method CreateKey, checked in AddKey and DeleteKey routines}}
\DoxyCodeLine{280                             \textcolor{comment}{//   old key filtered     new key filtered   iKeySts}}
\DoxyCodeLine{281                             \textcolor{comment}{//       Y                      Y              XB\_UPD\_KEY  2 -\/ update key if changed (delete and add)}}
\DoxyCodeLine{282                             \textcolor{comment}{//       Y                      N              XB\_DEL\_KEY  3 -\/ delete key}}
\DoxyCodeLine{283                             \textcolor{comment}{//       N                      Y              XB\_ADD\_KEY  1 -\/ add key}}
\DoxyCodeLine{284                             \textcolor{comment}{//       N                      N                          0 -\/ no update}}
\DoxyCodeLine{285 }
\DoxyCodeLine{286    xbInt16   iIxTagMode;    \textcolor{comment}{//  XB\_IX\_DBASE\_MODE or XB\_IX\_XBASE\_MODE}}
\DoxyCodeLine{287 }
\DoxyCodeLine{288 \};}
\DoxyCodeLine{290 }
\DoxyCodeLine{292 }
\DoxyCodeLine{311 \textcolor{keyword}{class }XBDLLEXPORT xbIxNdx : \textcolor{keyword}{public} xbIx \{}
\DoxyCodeLine{312  \textcolor{keyword}{public}:}
\DoxyCodeLine{313    xbIxNdx( xbDbf * d );}
\DoxyCodeLine{314    \string~xbIxNdx();}
\DoxyCodeLine{315    xbInt16  CheckTagIntegrity( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt );}
\DoxyCodeLine{316    xbInt16  CreateTag( \textcolor{keyword}{const} xbString \&sName, \textcolor{keyword}{const} xbString \&sKey, \textcolor{keyword}{const} xbString \&sFilter, xbInt16 iDescending, xbInt16 iUnique, xbInt16 iOverlay, \textcolor{keywordtype}{void} **vpTag );}
\DoxyCodeLine{317    xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpKey, xbInt32 lKeyLen, xbInt16 iRetrieveSw );}
\DoxyCodeLine{318 }
\DoxyCodeLine{319    xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbString \&s );}
\DoxyCodeLine{320    xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, \mbox{\hyperlink{namespacexb_a25f47b226ce924a5c78f97989b0744a2}{xbDouble}} \&d );}
\DoxyCodeLine{321    xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbDate \&dt );}
\DoxyCodeLine{322 }
\DoxyCodeLine{323    xbInt16  GetFirstKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw );}
\DoxyCodeLine{324 }
\DoxyCodeLine{325    xbInt16  GetIxTagMode( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{326 }
\DoxyCodeLine{327    xbInt16  GetLastKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 1 );}
\DoxyCodeLine{328    xbInt16  GetNextKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 1 );}
\DoxyCodeLine{329    xbInt16  GetPrevKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 1 );}
\DoxyCodeLine{330    xbInt32  GetKeyLen  ( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{331    \textcolor{keywordtype}{char}     GetKeyType ( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{332    xbString \&GetKeyExpression( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{333    xbString \&GetKeyFilter( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{334    \textcolor{keywordtype}{void}     *GetTag( xbInt16 iTagNo ) \textcolor{keyword}{const};}
\DoxyCodeLine{335    \textcolor{keywordtype}{void}     *GetTag( xbString \&sTagName ) \textcolor{keyword}{const};}
\DoxyCodeLine{336    xbString \&GetTagName( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{337    \textcolor{keyword}{const} \textcolor{keywordtype}{char} * GetTagName( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt ) \textcolor{keyword}{const};}
\DoxyCodeLine{338    xbInt16  GetTagCount() \textcolor{keyword}{const};}
\DoxyCodeLine{339 }
\DoxyCodeLine{340    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetUnique( \textcolor{keywordtype}{void} *vpTag = NULL ) \textcolor{keyword}{const};}
\DoxyCodeLine{341    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetSortOrder( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{342 }
\DoxyCodeLine{343    xbInt16  SetIxTagMode( \textcolor{keywordtype}{void} *vpTag, xbInt16 iMode );}
\DoxyCodeLine{344 }
\DoxyCodeLine{345    xbInt16  SetCurTag( xbInt16 iTagNo );}
\DoxyCodeLine{346    xbInt16  SetCurTag( xbString \&sTagName );}
\DoxyCodeLine{347 }
\DoxyCodeLine{348 \textcolor{preprocessor}{   \#ifdef XB\_DEBUG\_SUPPORT}}
\DoxyCodeLine{349    xbInt16 DumpTagBlocks( xbInt16 iOpt = 1, \textcolor{keywordtype}{void} *vpTag = NULL  );}
\DoxyCodeLine{350    xbInt16 DumpHeader( xbInt16 iOpt = 0, xbInt16 iFmt = 0 );}
\DoxyCodeLine{351    xbInt16 DumpIxForTag( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt );}
\DoxyCodeLine{352    \textcolor{keywordtype}{void}    DumpIxNodeChain( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt ) \textcolor{keyword}{const};}
\DoxyCodeLine{353    xbInt16 DumpNode( \textcolor{keywordtype}{void} * vpTag, xbIxNode * pNode, xbInt16 iOption ) \textcolor{keyword}{const};}
\DoxyCodeLine{354 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{355 }
\DoxyCodeLine{356 }
\DoxyCodeLine{357  \textcolor{keyword}{protected}:}
\DoxyCodeLine{358    \textcolor{keyword}{friend}   \textcolor{keyword}{class }xbDbf;}
\DoxyCodeLine{359    xbInt16  AddKey( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo );}
\DoxyCodeLine{360    xbIxNode *AllocateIxNode( xbUInt32 ulBufSize = 0, xbInt16 iOption = 0 );}
\DoxyCodeLine{361    xbInt16  CheckForDupKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{362    xbIxNode *CreateIxNode( xbUInt32 ulBufSize );}
\DoxyCodeLine{363    xbInt16  CreateKey( \textcolor{keywordtype}{void} * vpTag, xbInt16 iOpt );}
\DoxyCodeLine{364    xbInt16  DeleteFromNode( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo );}
\DoxyCodeLine{365    xbInt16  DeleteKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{366    xbInt16  DeleteTag( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{367    xbInt16  FindKeyForCurRec( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 0 );}
\DoxyCodeLine{368    xbInt16  GetKeyTypeN( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{369    xbInt16  GetKeySts( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{370    xbInt16  GetLastKey( xbUInt32 ulNodeNo, \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 1 );}
\DoxyCodeLine{371    xbInt16  InsertNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo, xbUInt32 uiPtr );}
\DoxyCodeLine{372    xbInt16  InsertNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo, \textcolor{keywordtype}{char} * cpKeyBuf, xbUInt32 uiPtr );}
\DoxyCodeLine{373    xbInt16  KeyExists( \textcolor{keywordtype}{void} *vpTag = NULL );}
\DoxyCodeLine{374    xbInt16  ReadHeadBlock(xbInt16 iOpt);   \textcolor{comment}{// read the header node of the disk NDX file}}
\DoxyCodeLine{375    xbInt16  ReindexTag( \textcolor{keywordtype}{void} **vpTag );}
\DoxyCodeLine{376    xbInt16  SplitNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, xbUInt32 uiPtr );}
\DoxyCodeLine{377    xbInt16  SplitNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, \textcolor{keywordtype}{char} *cpKeyBuf, xbUInt32 uiPtr );}
\DoxyCodeLine{378    xbInt16  UpdateTagKey( \textcolor{keywordtype}{char} cAction, \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo = 0 );}
\DoxyCodeLine{379    xbInt16  WriteHeadBlock( xbInt16 iOption );}
\DoxyCodeLine{380 }
\DoxyCodeLine{381  \textcolor{keyword}{private}:}
\DoxyCodeLine{382    xbInt16  AddKeyNewRoot( xbNdxTag *npTag, xbIxNode *npLeft, xbIxNode *npRight );}
\DoxyCodeLine{383    \textcolor{keywordtype}{void}     AppendNodeChain( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode );}
\DoxyCodeLine{384    xbInt16  GetDbfPtr( \textcolor{keywordtype}{void} *vpTag, xbInt16 iKeyNo, xbIxNode *npNode, xbUInt32 \&ulDbfPtr ) \textcolor{keyword}{const};}
\DoxyCodeLine{385    xbInt16  GetKeyPtr( \textcolor{keywordtype}{void} *vpTag, xbInt16 iKeyNo, xbIxNode *npNode, xbUInt32 \&ulKeyPtr ) \textcolor{keyword}{const};}
\DoxyCodeLine{386    xbInt16  GetLastKeyForBlockNo( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulBlockNo, \textcolor{keywordtype}{char} *cpKeyBuf );}
\DoxyCodeLine{387    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   IsLeaf( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode ) \textcolor{keyword}{const};}
\DoxyCodeLine{388    xbInt16  KeySetPosAdd( xbNdxTag *npTag, xbUInt32 ulAddKeyRecNo );}
\DoxyCodeLine{389    xbInt16  KeySetPosDel( xbNdxTag *npTag );}
\DoxyCodeLine{390    xbNdxTag *ndxTag;}
\DoxyCodeLine{391 \};}
\DoxyCodeLine{392 }
\DoxyCodeLine{393 \textcolor{preprocessor}{\#endif   }\textcolor{comment}{/* XB\_NDX\_SUPPORT */}\textcolor{preprocessor}{}}
\DoxyCodeLine{394 }
\DoxyCodeLine{395 }
\DoxyCodeLine{396 \textcolor{preprocessor}{\#ifdef XB\_MDX\_SUPPORT}}
\DoxyCodeLine{397 \textcolor{comment}{//\#define XB\_MDX\_BLOCK\_SIZE 1024}}
\DoxyCodeLine{398 }
\DoxyCodeLine{399 \textcolor{keyword}{struct }XBDLLEXPORT xbMdxTag \{}
\DoxyCodeLine{400 }
\DoxyCodeLine{401   \textcolor{comment}{// next 7 fields comprise the tag table entry}}
\DoxyCodeLine{402   xbUInt32      ulTagHdrPageNo;   \textcolor{comment}{// 512 byte page number, NOT block number}}
\DoxyCodeLine{403   \textcolor{keywordtype}{char}          cTagName[11];}
\DoxyCodeLine{404   \textcolor{keywordtype}{char}          cKeyFmt;          \textcolor{comment}{// always 0x10 w/ dBASE V7}}
\DoxyCodeLine{405   \textcolor{keywordtype}{char}          cLeftChild;       \textcolor{comment}{// cFwdTagThread}}
\DoxyCodeLine{406   \textcolor{keywordtype}{char}          cRightChild;      \textcolor{comment}{// cFwdTagThread2}}
\DoxyCodeLine{407   \textcolor{keywordtype}{char}          cParent;          \textcolor{comment}{// cBwdTagThread}}
\DoxyCodeLine{408   \textcolor{keywordtype}{char}          c2;}
\DoxyCodeLine{409   \textcolor{keywordtype}{char}          cKeyType;         \textcolor{comment}{// C,D,N}}
\DoxyCodeLine{410 }
\DoxyCodeLine{411   xbUInt32      ulRootPage;       \textcolor{comment}{// 512 byte page number, NOT block number}}
\DoxyCodeLine{412   xbUInt32      ulTagSize;        \textcolor{comment}{// Number of 512 byte pages allocated to the tag.   Tag size of two is a single 1024 block}}
\DoxyCodeLine{413 }
\DoxyCodeLine{414   \textcolor{keywordtype}{char}          cKeyFmt2;         \textcolor{comment}{// 0x10 -\/ base}}
\DoxyCodeLine{415                                   \textcolor{comment}{// 0x08 -\/ descending}}
\DoxyCodeLine{416                                   \textcolor{comment}{// 0x40 -\/ unique}}
\DoxyCodeLine{417   \textcolor{keywordtype}{char}          cKeyType2;}
\DoxyCodeLine{418   \textcolor{comment}{// one unused byte fits here}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420   \textcolor{keywordtype}{char}          cTag11;          \textcolor{comment}{// dBASE sets to 0x1B}}
\DoxyCodeLine{421   xbInt16       iKeyLen;}
\DoxyCodeLine{422   xbInt16       iKeysPerBlock;}
\DoxyCodeLine{423   xbInt16       iSecKeyType;}
\DoxyCodeLine{424   xbInt16       iKeyItemLen;    \textcolor{comment}{// iKeyLen + 4}}
\DoxyCodeLine{425 }
\DoxyCodeLine{426   \textcolor{keywordtype}{char}          cSerialNo;      \textcolor{comment}{// Increments +1 for each tag update}}
\DoxyCodeLine{427   \textcolor{keywordtype}{char}          cUnique;}
\DoxyCodeLine{428   xbString      *sKeyExp;       \textcolor{comment}{// Key expression}}
\DoxyCodeLine{429   \textcolor{keywordtype}{char}          cHasFilter;     \textcolor{comment}{// 0x00 or 0x01}}
\DoxyCodeLine{430   \textcolor{keywordtype}{char}          cHasKeys;       \textcolor{comment}{// 0x00 or 0x01}}
\DoxyCodeLine{431   xbUInt32      ulLeftChild;    \textcolor{comment}{// dBASE 7 sets this to the root page on tag creation}}
\DoxyCodeLine{432   xbUInt32      ulRightChild;   \textcolor{comment}{// dBASE 7 sets this to the root page on tag creation}}
\DoxyCodeLine{433 }
\DoxyCodeLine{434   \textcolor{keywordtype}{char}          cTagYY;}
\DoxyCodeLine{435   \textcolor{keywordtype}{char}          cTagMM;}
\DoxyCodeLine{436   \textcolor{keywordtype}{char}          cTagDD;}
\DoxyCodeLine{437 }
\DoxyCodeLine{438   \textcolor{keywordtype}{char}          cKeyFmt3;      \textcolor{comment}{// dBASE 7 sets this 0x01 if discreet field or 0x00 if calculated or combination field key expression on tag creation}}
\DoxyCodeLine{439 }
\DoxyCodeLine{440   xbString      *sFiltExp;     \textcolor{comment}{// Filter expression}}
\DoxyCodeLine{441 }
\DoxyCodeLine{442   time\_t        tNodeChainTs;}
\DoxyCodeLine{443   xbIxNode      *npNodeChain;}
\DoxyCodeLine{444   xbIxNode      *npCurNode;}
\DoxyCodeLine{445   xbExp         *exp;          \textcolor{comment}{// pointer to expression for expression based tags}}
\DoxyCodeLine{446   xbExp         *filter;       \textcolor{comment}{// pointer to expression for index filter}}
\DoxyCodeLine{447 }
\DoxyCodeLine{448   \textcolor{keywordtype}{char}          *cpKeyBuf;     \textcolor{comment}{// key buffer}}
\DoxyCodeLine{449   \textcolor{keywordtype}{char}          *cpKeyBuf2;    \textcolor{comment}{// key buffer}}
\DoxyCodeLine{450   xbString      *sTagName;     \textcolor{comment}{// string tag name}}
\DoxyCodeLine{451 }
\DoxyCodeLine{452 }
\DoxyCodeLine{453   xbMdxTag      *next;}
\DoxyCodeLine{454   \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}        bFoundSts;     \textcolor{comment}{// key found?  used to determine if new key should be added in XB\_EMULATE\_DBASE mode in AddKey}}
\DoxyCodeLine{455 }
\DoxyCodeLine{456 }
\DoxyCodeLine{457   xbInt16       iKeySts;       \textcolor{comment}{// key updated?  set in method CreateKey, checked in AddKey and DeleteKey routines}}
\DoxyCodeLine{458                                \textcolor{comment}{//   old key filtered     new key filtered   iKeySts}}
\DoxyCodeLine{459                                \textcolor{comment}{//       Y                      Y              XB\_UPD\_KEY  2 -\/ update key if changed (delete and add)}}
\DoxyCodeLine{460                                \textcolor{comment}{//       Y                      N              XB\_DEL\_KEY  3 -\/ delete key}}
\DoxyCodeLine{461                                \textcolor{comment}{//       N                      Y              XB\_ADD\_KEY  1 -\/ add key}}
\DoxyCodeLine{462                                \textcolor{comment}{//       N                      N                          0 -\/ no update}}
\DoxyCodeLine{463 }
\DoxyCodeLine{464 }
\DoxyCodeLine{465   xbInt16       iIxTagMode;    \textcolor{comment}{//  XB\_IX\_DBASE\_MODE or XB\_IX\_XBASE\_MODE}}
\DoxyCodeLine{466 }
\DoxyCodeLine{467 }
\DoxyCodeLine{468 \};}
\DoxyCodeLine{469 }
\DoxyCodeLine{470 }
\DoxyCodeLine{471 \textcolor{keyword}{class }XBDLLEXPORT xbIxMdx : \textcolor{keyword}{public} xbIx \{}
\DoxyCodeLine{472  \textcolor{keyword}{public}:}
\DoxyCodeLine{473    xbIxMdx( xbDbf * d );}
\DoxyCodeLine{474    \string~xbIxMdx();}
\DoxyCodeLine{475    \textcolor{keyword}{virtual} xbInt16  CheckTagIntegrity( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt );}
\DoxyCodeLine{476    \textcolor{keyword}{virtual} xbInt16  CreateTag( \textcolor{keyword}{const} xbString \&sName, \textcolor{keyword}{const} xbString \&sKey, \textcolor{keyword}{const} xbString \&sFilter, xbInt16 iDescending, xbInt16 iUnique, xbInt16 iOverlay, \textcolor{keywordtype}{void} **vpTag );}
\DoxyCodeLine{477    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vKey, xbInt32 lKeyLen, xbInt16 iRetrieveSw );}
\DoxyCodeLine{478    \textcolor{keyword}{virtual} xbInt16  FindKey( \textcolor{keywordtype}{void} *vpTag, \mbox{\hyperlink{namespacexb_a25f47b226ce924a5c78f97989b0744a2}{xbDouble}} dKey, xbInt16 iRetrieveSw );}
\DoxyCodeLine{479 }
\DoxyCodeLine{480    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbString \&s );}
\DoxyCodeLine{481    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, \mbox{\hyperlink{namespacexb_a25f47b226ce924a5c78f97989b0744a2}{xbDouble}} \&d );}
\DoxyCodeLine{482    \textcolor{keyword}{virtual} xbInt16  GetCurKeyVal( \textcolor{keywordtype}{void} *vpTag, xbDate \&dt );}
\DoxyCodeLine{483 }
\DoxyCodeLine{484    \textcolor{keyword}{virtual} xbInt16  GetFirstKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw );}
\DoxyCodeLine{485    \textcolor{keyword}{virtual} xbInt16  GetIxTagMode( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{486 }
\DoxyCodeLine{487    \textcolor{keyword}{virtual} xbString \&GetKeyExpression( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{488    \textcolor{keyword}{virtual} xbString \&GetKeyFilter( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{489    \textcolor{keyword}{virtual} \textcolor{keywordtype}{char}     GetKeyType( \textcolor{keyword}{const} \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{490    \textcolor{keyword}{virtual} xbInt16  GetLastKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw );}
\DoxyCodeLine{491    \textcolor{keyword}{virtual} xbInt16  GetNextKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw );}
\DoxyCodeLine{492    \textcolor{keyword}{virtual} xbInt16  GetPrevKey( \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw );}
\DoxyCodeLine{493    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetReuseEmptyNodesSw() \textcolor{keyword}{const};}
\DoxyCodeLine{494    \textcolor{keyword}{virtual} \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   GetSortOrder( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{495    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     *GetTag( xbInt16 iTagNo ) \textcolor{keyword}{const};}
\DoxyCodeLine{496    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     *GetTag( xbString \&sTagName ) \textcolor{keyword}{const};}
\DoxyCodeLine{497    \textcolor{keyword}{virtual} xbInt16  GetTagCount() \textcolor{keyword}{const};}
\DoxyCodeLine{498 }
\DoxyCodeLine{499    \textcolor{keyword}{virtual} xbString \&GetTagName( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{500    \textcolor{keyword}{virtual} \textcolor{keyword}{const} \textcolor{keywordtype}{char} * GetTagName( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOpt ) \textcolor{keyword}{const};}
\DoxyCodeLine{501    \textcolor{keyword}{virtual} \textcolor{keywordtype}{void}     GetTagName( \textcolor{keywordtype}{void} *vpTag, xbString \&sTagName );}
\DoxyCodeLine{502 }
\DoxyCodeLine{503    \textcolor{keyword}{virtual} xbInt16  GetUnique( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{504    \textcolor{keyword}{virtual} xbInt16  SetCurTag( xbInt16 iTagNo );}
\DoxyCodeLine{505    \textcolor{keyword}{virtual} xbInt16  SetCurTag( xbString \&sTagName );}
\DoxyCodeLine{506            \textcolor{keywordtype}{void}     SetReuseEmptyNodesSw( \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}} bReuse );}
\DoxyCodeLine{507 }
\DoxyCodeLine{508    \textcolor{keyword}{virtual} xbInt16  SetIxTagMode( \textcolor{keywordtype}{void} *vpTag, xbInt16 iMode );}
\DoxyCodeLine{509            \textcolor{keywordtype}{void}     TestStub( \textcolor{keywordtype}{char} *s, \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{510 }
\DoxyCodeLine{511  \textcolor{keyword}{protected}:}
\DoxyCodeLine{512    \textcolor{keyword}{friend}   \textcolor{keyword}{class }xbDbf;}
\DoxyCodeLine{513 }
\DoxyCodeLine{514    xbInt16  AddKey( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo );}
\DoxyCodeLine{515    xbIxNode *AllocateIxNode( xbMdxTag * mpTag, xbUInt32 ulBufSize, xbUInt32 ulBlock2 );}
\DoxyCodeLine{516    \textcolor{keywordtype}{void}     CalcBtreePointers();}
\DoxyCodeLine{517    \textcolor{keywordtype}{char}     CalcTagKeyFmt( xbExp \&exp );}
\DoxyCodeLine{518 }
\DoxyCodeLine{519    xbInt16  CheckForDupKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{520    \textcolor{keyword}{virtual}  xbInt16  Close();}
\DoxyCodeLine{521    xbInt16  CreateKey( \textcolor{keywordtype}{void} * vpTag, xbInt16 iOpt );}
\DoxyCodeLine{522    xbInt16  DeleteFromNode( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npNode, xbInt16 iSlotNo );}
\DoxyCodeLine{523    xbInt16  DeleteKey( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{524 }
\DoxyCodeLine{525    \textcolor{keyword}{virtual}  xbInt16  DeleteTag( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{526 }
\DoxyCodeLine{527    xbInt16  FindKeyForCurRec( \textcolor{keywordtype}{void} *vpTag, xbInt16 iRetrieveSw = 0 );}
\DoxyCodeLine{528    xbInt16  GetKeySts( \textcolor{keywordtype}{void} *vpTag ) \textcolor{keyword}{const};}
\DoxyCodeLine{529    xbInt16  GetLastKey( xbUInt32 ulBlockNo, \textcolor{keywordtype}{void} *vpTag, xbInt16 lRetrieveSw );}
\DoxyCodeLine{530    \textcolor{keywordtype}{void}     *GetTagTblPtr() \textcolor{keyword}{const};}
\DoxyCodeLine{531 }
\DoxyCodeLine{532    xbInt16  HarvestTagNodes( xbMdxTag *mpTag, \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}} bRecycleRoot = \mbox{\hyperlink{xbtypes_8h_adc4b6ca5ad299f63675136d9e03938cc}{xbFalse}} );}
\DoxyCodeLine{533    \textcolor{keywordtype}{void}     Init( xbInt16 iOpt = 0 );}
\DoxyCodeLine{534    xbInt16  InsertNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode, xbInt16 iSlotNo, xbUInt32 uiPtr );}
\DoxyCodeLine{535    xbInt16  InsertNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode, xbInt16 iSlotNo, \textcolor{keywordtype}{char} *cpKeyBuf, xbUInt32 uiPtr );}
\DoxyCodeLine{536    xbInt16  KeyExists( \textcolor{keywordtype}{void} * );}
\DoxyCodeLine{537    xbInt16  LoadTagTable();}
\DoxyCodeLine{538    xbInt16  ReadHeadBlock(xbInt16 iOpt);   \textcolor{comment}{// read the header node of the disk file}}
\DoxyCodeLine{539    \textcolor{keyword}{virtual}  xbInt16  ReindexTag( \textcolor{keywordtype}{void} **vpTag );}
\DoxyCodeLine{540    xbInt16  SplitNodeI( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, xbUInt32 uiPtr );}
\DoxyCodeLine{541    xbInt16  SplitNodeL( \textcolor{keywordtype}{void} *vpTag, xbIxNode * npLeft, xbIxNode *npRight, xbInt16 iSlotNo, \textcolor{keywordtype}{char} *cpKeyBuf, xbUInt32 uiPtr );}
\DoxyCodeLine{542    xbInt16  UpdateTagKey( \textcolor{keywordtype}{char} cAction, \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulRecNo = 0 );}
\DoxyCodeLine{543    xbInt16  WriteHeadBlock( xbInt16 iOption );}
\DoxyCodeLine{544 }
\DoxyCodeLine{545 \textcolor{preprocessor}{   \#ifdef XB\_DEBUG\_SUPPORT}}
\DoxyCodeLine{546    xbInt16  DumpTagBlocks( xbInt16 iOpt = 1, \textcolor{keywordtype}{void} *vpTag = NULL  );}
\DoxyCodeLine{547    xbInt16  DumpFreeBlocks( xbInt16 iOpt = 0 );}
\DoxyCodeLine{548    xbInt16  DumpHeader( xbInt16 iOpt = 0, xbInt16 iFmtOpt = 0 );}
\DoxyCodeLine{549    xbInt16  DumpIxForTag( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt );}
\DoxyCodeLine{550    \textcolor{keywordtype}{void}     DumpIxNodeChain( \textcolor{keywordtype}{void} *vpTag, xbInt16 iOutputOpt ) \textcolor{keyword}{const};}
\DoxyCodeLine{551 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{552 }
\DoxyCodeLine{553 }
\DoxyCodeLine{554    xbMdxTag *mdxTagTbl;}
\DoxyCodeLine{555 }
\DoxyCodeLine{556 \textcolor{comment}{// MDX File Header Fields}}
\DoxyCodeLine{557    \textcolor{keywordtype}{char}     cVersion;}
\DoxyCodeLine{558    \textcolor{keywordtype}{char}     cCreateYY;}
\DoxyCodeLine{559    \textcolor{keywordtype}{char}     cCreateMM;}
\DoxyCodeLine{560    \textcolor{keywordtype}{char}     cCreateDD;}
\DoxyCodeLine{561    xbString sFileName;}
\DoxyCodeLine{562    xbInt16  iBlockFactor;          \textcolor{comment}{// 1-\/32 \#of 512 byte segments in a block}}
\DoxyCodeLine{563 }
\DoxyCodeLine{564    \textcolor{comment}{// use file version}}
\DoxyCodeLine{565    \textcolor{comment}{// xbInt16  iBlockSize;         // Stored at the xbFile level}}
\DoxyCodeLine{566 }
\DoxyCodeLine{567    \textcolor{keywordtype}{char}     cProdIxFlag;}
\DoxyCodeLine{568    \textcolor{keywordtype}{char}     cTagEntryCnt;}
\DoxyCodeLine{569    xbInt16  iTagLen;}
\DoxyCodeLine{570    xbInt16  iTagUseCnt;}
\DoxyCodeLine{571    \textcolor{keywordtype}{char}     cNextTag;             \textcolor{comment}{// byte 28 +1}}
\DoxyCodeLine{572    \textcolor{keywordtype}{char}     c1B;                  \textcolor{comment}{// always 0x1B}}
\DoxyCodeLine{573    xbUInt32 ulPageCnt;            \textcolor{comment}{// number of 512 byte pages in the mdx file}}
\DoxyCodeLine{574    xbUInt32 ulFirstFreePage;      \textcolor{comment}{// page number corresponding to the next free block}}
\DoxyCodeLine{575    xbUInt32 ulNoOfBlockAvail;     \textcolor{comment}{// might be improperly named??  not sure how it is used}}
\DoxyCodeLine{576    \textcolor{keywordtype}{char}     cUpdateYY;}
\DoxyCodeLine{577    \textcolor{keywordtype}{char}     cUpdateMM;}
\DoxyCodeLine{578    \textcolor{keywordtype}{char}     cUpdateDD;}
\DoxyCodeLine{579    \textcolor{comment}{// end of MDX Header fields}}
\DoxyCodeLine{580 }
\DoxyCodeLine{581 }
\DoxyCodeLine{582    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}    bReuseEmptyNodes;     \textcolor{comment}{// Reuese empty MDX nodes when all keys deleted?}}
\DoxyCodeLine{583                                    \textcolor{comment}{// dBASE 7.x and MS ODBC drivers do not reuse empty nodes, leaves them stranded in the file}}
\DoxyCodeLine{584                                    \textcolor{comment}{// Codebase 6.x reuses empty nodes.}}
\DoxyCodeLine{585                                    \textcolor{comment}{// Setting this to True will reuse empty nodes in the same manner Codebase 6.x reuses them.}}
\DoxyCodeLine{586 }
\DoxyCodeLine{587 }
\DoxyCodeLine{588  \textcolor{keyword}{private}:}
\DoxyCodeLine{589    xbInt16  AddKeyNewRoot( xbMdxTag *npTag, xbIxNode *npLeft, xbIxNode *npRight );}
\DoxyCodeLine{590    \textcolor{keywordtype}{void}     AppendNodeChain( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode );}
\DoxyCodeLine{591    xbUInt32 BlockToPage( xbUInt32 ulBlockNo );}
\DoxyCodeLine{592    xbMdxTag *ClearTagTable();}
\DoxyCodeLine{593    xbInt16  DumpBlock( xbInt16 iOpt, xbUInt32 ulBlockNo, xbMdxTag * mpTag );}
\DoxyCodeLine{594    xbInt16  GetDbfPtr( \textcolor{keywordtype}{void} *vpTag, xbInt16 iKeyNo, xbIxNode *npNode, xbUInt32 \&ulDbfPtr ) \textcolor{keyword}{const};}
\DoxyCodeLine{595    xbInt16  GetKeyPtr( \textcolor{keywordtype}{void} *vpTag, xbInt16 iKeyNo, xbIxNode *npNode, xbUInt32 \&ulKeyPtr ) \textcolor{keyword}{const};}
\DoxyCodeLine{596    xbInt16  GetLastKeyForBlockNo( \textcolor{keywordtype}{void} *vpTag, xbUInt32 ulBlockNo, \textcolor{keywordtype}{char} *cpKeyBuf );}
\DoxyCodeLine{597    xbInt16  HarvestEmptyNode( xbMdxTag *mpTag, xbIxNode *npNode, xbInt16 iOpt, \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}} bHarvestRoot = \mbox{\hyperlink{xbtypes_8h_adc4b6ca5ad299f63675136d9e03938cc}{xbFalse}} );}
\DoxyCodeLine{598    \mbox{\hyperlink{namespacexb_ab1a750481dd487f0d384aa1d200dff0f}{xbBool}}   IsLeaf( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode ) \textcolor{keyword}{const};}
\DoxyCodeLine{599    xbInt16  KeySetPosAdd( xbMdxTag *mpTag, xbUInt32 ulAddKeyRecNo );}
\DoxyCodeLine{600    xbInt16  KeySetPosDel( xbMdxTag *mpTag );}
\DoxyCodeLine{601    xbInt16  LoadTagDetail( xbInt16 iOption, xbMdxTag *tte );}
\DoxyCodeLine{602    xbUInt32 PageToBlock( xbUInt32 ulPageNo );}
\DoxyCodeLine{603    xbInt16  TagSerialNo( xbInt16 iOption, xbMdxTag *mpTag );}
\DoxyCodeLine{604    xbInt16  UpdateTagSize( xbMdxTag *mpTag, xbUInt32 ulTagSz );}
\DoxyCodeLine{605 }
\DoxyCodeLine{606 \textcolor{preprocessor}{   \#ifdef XB\_DEBUG\_SUPPORT}}
\DoxyCodeLine{607    xbInt16  PrintKey( \textcolor{keywordtype}{void} *vpTag, xbIxNode *npNode, xbInt16 iKeyNo, xbInt16 iDepth, \textcolor{keywordtype}{char} cType, xbInt16 iOutputOpt );}
\DoxyCodeLine{608 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{609 }
\DoxyCodeLine{610 }
\DoxyCodeLine{611     \};}
\DoxyCodeLine{612 \textcolor{preprocessor}{   \#endif   }\textcolor{comment}{/* XB\_MDX\_SUPPORT */}\textcolor{preprocessor}{}}
\DoxyCodeLine{613 }
\DoxyCodeLine{614 }
\DoxyCodeLine{615 \textcolor{preprocessor}{\#ifdef XB\_TDX\_SUPPORT}}
\DoxyCodeLine{616 }
\DoxyCodeLine{617 \textcolor{keyword}{class }XBDLLEXPORT xbIxTdx : \textcolor{keyword}{public} xbIxMdx \{}
\DoxyCodeLine{618  \textcolor{keyword}{public}:}
\DoxyCodeLine{619    xbIxTdx( xbDbf * d );}
\DoxyCodeLine{620    \string~xbIxTdx();}
\DoxyCodeLine{621 }
\DoxyCodeLine{622    xbInt16  CreateTag( \textcolor{keyword}{const} xbString \&sName, \textcolor{keyword}{const} xbString \&sKey, \textcolor{keyword}{const} xbString \&sFilter, xbInt16 iDescending, xbInt16 iUnique, xbInt16 iOverlay, \textcolor{keywordtype}{void} **vpTag );}
\DoxyCodeLine{623 }
\DoxyCodeLine{624  \textcolor{keyword}{protected}:}
\DoxyCodeLine{625    \textcolor{keyword}{friend}   \textcolor{keyword}{class }xbDbf;}
\DoxyCodeLine{626    xbInt16  Close();}
\DoxyCodeLine{627    xbInt16  DeleteTag( \textcolor{keywordtype}{void} *vpTag );}
\DoxyCodeLine{628 }
\DoxyCodeLine{629  \textcolor{keyword}{private}:}
\DoxyCodeLine{630 \};}
\DoxyCodeLine{631 }
\DoxyCodeLine{632 \textcolor{preprocessor}{\#endif   }\textcolor{comment}{/* XB\_TDX\_SUPPORT  */}\textcolor{preprocessor}{}}
\DoxyCodeLine{633 }
\DoxyCodeLine{634 }
\DoxyCodeLine{635   \}         \textcolor{comment}{/* namespace xb     */}}
\DoxyCodeLine{636 \textcolor{preprocessor}{ \#endif     }\textcolor{comment}{/* XB\_INDEX\_SUPPORT */}\textcolor{preprocessor}{}}
\DoxyCodeLine{637 \textcolor{preprocessor}{\#endif      }\textcolor{comment}{/* \_\_XB\_INDEX\_H\_\_   */}\textcolor{preprocessor}{}}

\end{DoxyCode}
